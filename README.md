# PythonCRM
# Lead Distribution CRM

Мини-CRM система для автоматического распределения лидов между операторами по источникам.

## Цель проекта

Реализация сервиса на Python который:
- Хранит операторов и их загрузку
- Хранит лидов и обращения из разных источников  
- Автоматически распределяет новые обращения между операторами
- Учитывает лимиты нагрузки и весовое соотношение операторов

## Архитектура

### Модели данных

- **Operator** - оператор (активность, лимит нагрузки)
- **Lead** - лид (идентифицируется по external_id, phone, email)
- **Source** - источник обращения (бот, канал)
- **OperatorCompetence** - вес оператора для источника
- **LeadContact** - обращение лида

### Алгоритм распределения

1. **Идентификация лида** по external_id → phone → email
2. **Поиск доступных операторов**:
   - Активен (`is_active = True`)
   - Не превысил лимит нагрузки
   - Имеет компетенцию для источника
3. **Взвешенный выбор** - случайный выбор с вероятностями пропорциональными весам
4. **Создание обращения** с назначением оператора

## Быстрый старт

### Установка и запуск

1. **Создайте виртуальное окружение**:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

2. **Установите зависимости:**:
```bash
pip install -r requirements.txt
```

3. **Запустите сервер:**:
```bash
cd app
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```
4. **Откройте в браузере: http://localhost:8000/docs**

### Тестирование
```bash
python tests/test.py
```